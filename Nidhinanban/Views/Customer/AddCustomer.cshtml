@{
    ViewData["Title"] = "Add Customers";
}

<style>

    .profile-image {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        object-fit: cover;
        cursor: pointer;
        display: block;
        margin: 10px auto;
    }

    .doc-image {
        width: 100%;
        max-width: 100%;
        height: 150px;
        object-fit: cover;
        border: 2px solid #007BFF;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 10px;
    }


    label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
        text-align: left;
    }

    input[type="text"],
    textarea {
        width: 100%;
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }

    .form-actions {
        margin-top: 20px;
        display: flex;
        justify-content: space-between;
    }

    .form-actions button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
    }

    .btn-save:hover {
        background-color: #28a745;
        color: white;
        transition: background-color 0.3s;
    }

    .btn-clear:hover {
        background-color: #dc3545;
        color: white;
        transition: background-color 0.3s;
    }

    .btn-next:hover {
        background-color: #007bff;
        color: white;
        transition: background-color 0.3s;
    }

    .btn-save,
    .btn-clear,
    .btn-next {
        background-color: lightgray;
        color: black;
    }

    #my_camera {
        display: none;
        margin: 10px auto;
        text-align: center;
    }

    .webcam-buttons {
        text-align: center;
        margin-top: 10px;
    }
</style>

<div>
     <div class="mx-auto">
                 <div id="cam"></div>
                 <button onclick="opencam()">Open Camera</button>
<button onclick="changecam()">Switch Camera</button>
<button onclick="closecam()">Close Camera</button>
                 </div>
    <form>
        <a class="btn btn-outline-light text-black border border-10" asp-controller="Home" asp-action="Index">
            <img width="25" height="25" src="https://img.icons8.com/plumpy/50/back.png" alt="back" /> Back To Dashboard
        </a>
        
        <div class="card mx-auto col-10 my-5 mx-auto border border-10 shadow p-3">
            <!-- Profile Image -->
            <div>
               

                <label>Profile Picture</label>
                <img id="profilePic"  class="file profile-image border border-1 border-dark" src="https://img.icons8.com/fluency/240/test-account--v1.png" onclick="opencam()" />
                <input type="file" name="file" class="form-control w-25 mx-auto">k</input>
                
            </div>
            <div class="container my-4">
                <div class="row">
                    <!-- Name -->
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <label>Customer Name</label>
                        <input type="text" id="customerName" placeholder="Enter customer name"
                            onblur="setImagesBasedOnName()" />
                    </div>
                
                <!-- Phone -->
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <label>Phone Number</label>
                    <input type="text" placeholder="Enter phone number" />
                </div>
            </div>
            <div class="row mt-sm-2 mt-md-4 mt-lg-4 ">
                <!-- Address -->
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <label>Address</label>
                    <textarea rows="3" placeholder="Enter address"></textarea>
                </div>

                <!-- House Picture -->
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <label>House Picture</label>
                    <div class="">
                        <img id="housePic" class="img-fluid img-thumbnail border border-dark" 
         style="height:200px; max-height: 200px; object-fit: contain;" src="../img/house.png" onclick="openCamera('housePic')" />
                    </div>
                    <input type="file" class="form-control mt-2" id="houseuploadbtn" captured accept=".jpeg,.jpg,.png" />
                </div>
            </div>

            <div class="row mt-sm-2 mt-md-5 mt-lg-5 ">
                <!-- PAN Picture -->
                <div class="col-sm-12 col-md-6 col-lg-6 d-flex-row justify-content-center">
                    <label>PAN Picture</label>
                    <div style="">
                        <img id="panPic" class="img-fluid w-100 img-thumbnail border border-dark" 
         style="height:200px; max-height: 200px; object-fit: contain;" src="../img/Pan-Card.png" onclick="openCamera('panPic')" />
                    </div>
                <input type="file" class="form-control mt-2" id="pancarduploadbtn" />
                </div>

                <!-- Aadhaar Picture -->
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <label>Aadhaar Picture</label>
                    <div class="">
                        <img id="aadhaarPic" class="img-fluid img-thumbnail w-100 border border-dark" 
         style="height:200px;max-height: 200px; object-fit: contain;" src="../img/aadhaarpics.png" onclick="openCamera('aadhaarPic')" />
                    </div>
                    <input type="file" class="form-control mt-2" id="aadhaarpicuploadbtn" />
                </div>
            </div>
                <!-- Action Buttons -->
                <div class="form-actions d-flex flex-wrap justify-content-evenly gap-2">
                    <button type="button" class="btn btn-success flex-fill text-nowrap mx-1 "><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-floppy-fill" viewBox="0 0 16 16">
  <path d="M0 1.5A1.5 1.5 0 0 1 1.5 0H3v5.5A1.5 1.5 0 0 0 4.5 7h7A1.5 1.5 0 0 0 13 5.5V0h.086a1.5 1.5 0 0 1 1.06.44l1.415 1.414A1.5 1.5 0 0 1 16 2.914V14.5a1.5 1.5 0 0 1-1.5 1.5H14v-5.5A1.5 1.5 0 0 0 12.5 9h-9A1.5 1.5 0 0 0 2 10.5V16h-.5A1.5 1.5 0 0 1 0 14.5z"/>
  <path d="M3 16h10v-5.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5zm9-16H4v5.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5zM9 1h2v4H9z"/>
</svg> Save</button>
                    <button type="button" class="btn btn-danger flex-fill text-nowrap mx-1 " onclick="clearForm()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square-fill" viewBox="0 0 16 16">
  <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708"/>
</svg> Clear</button>
                    <button type="button" class="btn btn-primary flex-fill text-nowrap mx-1">
                        Next <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"/>
</svg> </button>
                </div>
            </div>
    </form>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.26/webcam.min.js"></script>
<script>
let cameralist = [];
let currentCamIndex = 0;

function opencam() {
  navigator.mediaDevices.enumerateDevices()
    .then(devices => {
      cameralist = devices
        .filter(device => device.kind === 'videoinput')
        .map(device => device.deviceId);

      if (cameralist.length === 0) {
        console.error("No cameras found");
        return;
      }

      currentCamIndex = 0;
      useCamera(cameralist[currentCamIndex]);
    })
    .catch(err => console.error("Device enumeration failed:", err));
}

function useCamera(deviceId) {
  // Reset previous stream
  Webcam.reset();

  // Set constraints with exact deviceId
  Webcam.set({
    width: 320,
    height: 240,
    image_format: 'jpeg',
    jpeg_quality: 90,
    constraints: {
      video: {
        deviceId: { exact: deviceId }
      }
    }
  });

  // Attach camera stream to the DOM element
  Webcam.attach('#cam');
}

function changecam() {
  if (cameralist.length === 0) return;

  // Cycle to next camera
  currentCamIndex = (currentCamIndex + 1) % cameralist.length;
  useCamera(cameralist[currentCamIndex]);
}

function closecam() {
  Webcam.reset();
}

  // Capture snapshot and show in #results
  function takeSnapshot() {
    Webcam.snap(function(data_uri) {
      document.getElementById('results').innerHTML =
        '<h3>Snapshot:</h3><img src="' + data_uri + '"/>';
    });
  }

   var uploadhouseBtn = document.getElementById("houseuploadbtn");
    var uploadPanbtn=document.getElementById("pancarduploadbtn");
    var uploadaadhaarBtn=document.getElementById("aadhaarpicuploadbtn");

uploadhouseBtn.addEventListener('change', (e) => {
    const currFiles = e.target.files;
    if (currFiles.length > 0) {
        let src = URL.createObjectURL(currFiles[0]);
        let imagePreview = document.getElementById('housePic');
        imagePreview.src = src;
    }
});

uploadPanbtn.addEventListener('change', (e) => {
    const currFiles = e.target.files;
    if (currFiles.length > 0) {
        let src = URL.createObjectURL(currFiles[0]);
        let imagePreview = document.getElementById('panPic');
        imagePreview.src = src;
    }
});

uploadaadhaarBtn.addEventListener('change', (e) => {
    const currFiles = e.target.files;
    if (currFiles.length > 0) {
        let src = URL.createObjectURL(currFiles[0]);
        let imagePreview = document.getElementById('aadhaarPic');
        imagePreview.src = src;
    }
});


    for (let id in placeholders) {
        document.getElementById(id).src = placeholders[id];
    }

    function clearForm() {
        document.querySelectorAll('input[type="text"], textarea,input[type="file"]').forEach(e => e.value = '');
        document.getElementById('housePic').src="../img/house.png";
        document.getElementById('aadhaarPic').src="../img/aadhaarpics.png";
        document.getElementById('panPic').src="../img/Pan-Card.png";
    }
     

</script>
